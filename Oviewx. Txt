Thanks for confirming — since you’re using the correct object (SP.ViewCreationInformation) and still getting:

> set_viewXml is not a function



this likely means the version of the JSOM API loaded in your SharePoint environment doesn’t support set_viewXml(). This sometimes happens in classic SharePoint or restricted modern environments.


---

✅ Solution: Use set_query() Instead of set_viewXml()

You can embed the CAML query part (no <ViewFields>, no <RowLimit>) inside set_query(), like this:

<script type="text/javascript">
    function createSimpleTitleView() {
        var ctx = SP.ClientContext.get_current();
        var list = ctx.get_web().get_lists().getByTitle("YourListName");

        var camlQuery =
            "<Query>" +
                "<OrderBy>" +
                    "<FieldRef Name='Title' Ascending='TRUE' />" +
                "</OrderBy>" +
            "</Query>";

        var viewInfo = new SP.ViewCreationInformation();
        viewInfo.set_title("Title A-Z Only");
        viewInfo.set_query(camlQuery); // Use this instead of set_viewXml
        viewInfo.set_viewTypeKind(SP.ViewType.none);
        viewInfo.set_paged(true);
        viewInfo.set_rowLimit(50);

        var views = list.get_views();
        views.add(viewInfo);

        ctx.load(views);
        ctx.executeQueryAsync(
            function () {
                alert("View created successfully.");
            },
            function (sender, args) {
                alert("Failed to create view: " + args.get_message());
            }
        );
    }

    SP.SOD.executeFunc('sp.js', 'SP.ClientContext', createSimpleTitleView);
</script>


---

What’s Missing Without set_viewXml()?

You can’t define <ViewFields> here, so it’ll use default fields (including Title).

To customize displayed columns, you'd need to do that separately via the UI or additional JSOM calls.



---

If you want a version with full column control or need to exclude Title, we can use REST or PnP JS — just let me know your environment (Classic, Modern, Online/On-Prem).

