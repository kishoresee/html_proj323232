Ah, got it! If you're getting set_viewXml is not a function, the issue is likely one of these:


---

1. Root Cause: Wrong Object

You're probably calling set_viewXml() on the wrong object. That function is only valid on SP.ViewCreationInformation objects — not on SP.View, SP.List, or anything else.


---

✅ Correct Usage (Fully CAML-based view)

<script type="text/javascript">
    function createSimpleTitleView() {
        var ctx = SP.ClientContext.get_current();
        var list = ctx.get_web().get_lists().getByTitle("YourListName");

        var viewXml =
            "<View>" +
                "<Query>" +
                    "<OrderBy>" +
                        "<FieldRef Name='Title' Ascending='TRUE' />" +
                    "</OrderBy>" +
                "</Query>" +
                "<ViewFields>" +
                    "<FieldRef Name='Title' />" +
                "</ViewFields>" +
                "<RowLimit>50</RowLimit>" +
            "</View>";

        var viewInfo = new SP.ViewCreationInformation(); // Must be this object
        viewInfo.set_title("Title A-Z Only");
        viewInfo.set_viewTypeKind(SP.ViewType.none);
        viewInfo.set_paged(true);
        viewInfo.set_rowLimit(50);
        viewInfo.set_viewXml(viewXml); // Make sure you're calling on this object

        var views = list.get_views();
        views.add(viewInfo);

        ctx.load(views);
        ctx.executeQueryAsync(
            function () {
                alert("View created successfully.");
            },
            function (sender, args) {
                alert("Failed to create view: " + args.get_message());
            }
        );
    }

    SP.SOD.executeFunc('sp.js', 'SP.ClientContext', createSimpleTitleView);
</script>


---

2. Bonus Tip — How to Debug

Put a console.log(viewInfo) right before viewInfo.set_viewXml(viewXml); — if it doesn't show [SP.ViewCreationInformation], you're not working with the correct object.


---

Still Getting That Error?

Double-check these:

Make sure the SharePoint page has loaded sp.js using SP.SOD.executeFunc.

Make sure you're not using viewInfo = list.get_views() — that would be incorrect.



---

Let me know the exact line where the error shows up (or share the updated snippet), and I’ll pinpoint it for you!

